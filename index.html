<!DOCTYPE html>
<html>
<head>
  <title>Login Petugas RT</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
  <div class="card">
    <h2>Login Petugas</h2>

    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <button id="loginBtn">Login</button>

    <p id="errorMsg" style="color:#ef4444;"></p>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";
import { firebaseConfig } from "./firebase-config.js";

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

document.getElementById("loginBtn").addEventListener("click", () => {
  const username = document.getElementById("username").value.trim();
  const password = document.getElementById("password").value.trim();

  const email = username + "@rt02.local";

  signInWithEmailAndPassword(auth, email, password)
  .then(() => {
    window.location.href = "dashboard.html";
  })
  .catch(err => {
    document.getElementById("errorMsg").innerText = "Login gagal, cek username & password!";
  });
});

// stay logged in
onAuthStateChanged(auth, user => {
  if(user){
    window.location.href = "dashboard.html";
  }
});
</script>

</body>
</html>
